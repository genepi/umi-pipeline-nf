{
    "Should detect the same UMIs - long adapter": {
        "content": [
            {
                "0": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ]
                ],
                "1": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.tsv:md5,ad5e1bbeb6edb594841e6cfd3172d20c"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.tsv:md5,1d7cb5b915aa09b2dc37531f66222a45"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.tsv:md5,fb3a528714e818653113163369c6dcf8"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.tsv:md5,0dba9d0ed906743cc8150b8bea054b35"
                    ]
                ],
                "umi_extract_fastq": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ]
                ],
                "umi_extract_fastq_stats": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.tsv:md5,ad5e1bbeb6edb594841e6cfd3172d20c"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.tsv:md5,1d7cb5b915aa09b2dc37531f66222a45"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.tsv:md5,fb3a528714e818653113163369c6dcf8"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.tsv:md5,0dba9d0ed906743cc8150b8bea054b35"
                    ]
                ]
            }
        ],
        "meta": {
            "nf-test": "0.9.0-rc2",
            "nextflow": "24.10.0"
        },
        "timestamp": "2025-10-07T15:35:06.930331069"
    },
    "Should detect the UMIs using context primer": {
        "content": [
            {
                "0": [
                    [
                        "barcode_context",
                        "lpa2645",
                        "extracted_umis_barcode_context_1.fastq:md5,d98f53ef8fb52f5ca0cffda16e10c5b5"
                    ]
                ],
                "1": [
                    [
                        "barcode_context",
                        "lpa2645",
                        "extracted_umis_barcode_context_1.tsv:md5,242202b6b70f9216e3594432722bfbc8"
                    ]
                ],
                "umi_extract_fastq": [
                    [
                        "barcode_context",
                        "lpa2645",
                        "extracted_umis_barcode_context_1.fastq:md5,d98f53ef8fb52f5ca0cffda16e10c5b5"
                    ]
                ],
                "umi_extract_fastq_stats": [
                    [
                        "barcode_context",
                        "lpa2645",
                        "extracted_umis_barcode_context_1.tsv:md5,242202b6b70f9216e3594432722bfbc8"
                    ]
                ]
            }
        ],
        "meta": {
            "nf-test": "0.9.0-rc2",
            "nextflow": "24.10.0"
        },
        "timestamp": "2025-10-07T15:35:24.97172069"
    },
    "Should detect the same UMIs - short adapter": {
        "content": [
            {
                "0": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ]
                ],
                "1": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.tsv:md5,ad5e1bbeb6edb594841e6cfd3172d20c"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.tsv:md5,1d7cb5b915aa09b2dc37531f66222a45"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.tsv:md5,fb3a528714e818653113163369c6dcf8"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.tsv:md5,0dba9d0ed906743cc8150b8bea054b35"
                    ]
                ],
                "umi_extract_fastq": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ]
                ],
                "umi_extract_fastq_stats": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.tsv:md5,ad5e1bbeb6edb594841e6cfd3172d20c"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.tsv:md5,1d7cb5b915aa09b2dc37531f66222a45"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.tsv:md5,fb3a528714e818653113163369c6dcf8"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.tsv:md5,0dba9d0ed906743cc8150b8bea054b35"
                    ]
                ]
            }
        ],
        "meta": {
            "nf-test": "0.9.0-rc2",
            "nextflow": "24.10.0"
        },
        "timestamp": "2025-10-07T15:34:55.049117799"
    },
    "Should detect UMIs": {
        "content": [
            {
                "0": [
                    [
                        "barcode_context",
                        "lpa2645",
                        "extracted_umis_barcode_context_1.fastq:md5,d98f53ef8fb52f5ca0cffda16e10c5b5"
                    ]
                ],
                "1": [
                    [
                        "barcode_context",
                        "lpa2645",
                        "extracted_umis_barcode_context_1.tsv:md5,242202b6b70f9216e3594432722bfbc8"
                    ]
                ],
                "umi_extract_fastq": [
                    [
                        "barcode_context",
                        "lpa2645",
                        "extracted_umis_barcode_context_1.fastq:md5,d98f53ef8fb52f5ca0cffda16e10c5b5"
                    ]
                ],
                "umi_extract_fastq_stats": [
                    [
                        "barcode_context",
                        "lpa2645",
                        "extracted_umis_barcode_context_1.tsv:md5,242202b6b70f9216e3594432722bfbc8"
                    ]
                ]
            }
        ],
        "meta": {
            "nf-test": "0.9.0-rc2",
            "nextflow": "24.10.0"
        },
        "timestamp": "2025-10-07T15:35:15.925070338"
    },
    "Should output empty file": {
        "content": [
            {
                "0": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ]
                ],
                "1": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.tsv:md5,ad5e1bbeb6edb594841e6cfd3172d20c"
                    ]
                ],
                "umi_extract_fastq": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ]
                ],
                "umi_extract_fastq_stats": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.tsv:md5,ad5e1bbeb6edb594841e6cfd3172d20c"
                    ]
                ]
            }
        ],
        "meta": {
            "nf-test": "0.9.0-rc2",
            "nextflow": "24.10.0"
        },
        "timestamp": "2025-10-07T15:35:32.631398014"
    },
    "Should not find any UMI": {
        "content": [
            {
                "0": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ]
                ],
                "1": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.tsv:md5,ad5e1bbeb6edb594841e6cfd3172d20c"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.tsv:md5,1d7cb5b915aa09b2dc37531f66222a45"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.tsv:md5,fb3a528714e818653113163369c6dcf8"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.tsv:md5,0dba9d0ed906743cc8150b8bea054b35"
                    ]
                ],
                "umi_extract_fastq": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ]
                ],
                "umi_extract_fastq_stats": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.tsv:md5,ad5e1bbeb6edb594841e6cfd3172d20c"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.tsv:md5,1d7cb5b915aa09b2dc37531f66222a45"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.tsv:md5,fb3a528714e818653113163369c6dcf8"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.tsv:md5,0dba9d0ed906743cc8150b8bea054b35"
                    ]
                ]
            }
        ],
        "meta": {
            "nf-test": "0.9.0-rc2",
            "nextflow": "24.10.0"
        },
        "timestamp": "2025-10-07T15:35:44.486305974"
    },
    "Should run without failures": {
        "content": [
            {
                "0": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ]
                ],
                "1": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.tsv:md5,ad5e1bbeb6edb594841e6cfd3172d20c"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.tsv:md5,1d7cb5b915aa09b2dc37531f66222a45"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.tsv:md5,fb3a528714e818653113163369c6dcf8"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.tsv:md5,0dba9d0ed906743cc8150b8bea054b35"
                    ]
                ],
                "umi_extract_fastq": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.fastq:md5,d41d8cd98f00b204e9800998ecf8427e"
                    ]
                ],
                "umi_extract_fastq_stats": [
                    [
                        "barcode02",
                        "lpa2645",
                        "extracted_umis_barcode02_1.tsv:md5,ad5e1bbeb6edb594841e6cfd3172d20c"
                    ],
                    [
                        "barcode03",
                        "lpa2645",
                        "extracted_umis_barcode03_2.tsv:md5,1d7cb5b915aa09b2dc37531f66222a45"
                    ],
                    [
                        "barcode04",
                        "lpa2645",
                        "extracted_umis_barcode04_3.tsv:md5,fb3a528714e818653113163369c6dcf8"
                    ],
                    [
                        "barcode05",
                        "lpa2645",
                        "extracted_umis_barcode05_4.tsv:md5,0dba9d0ed906743cc8150b8bea054b35"
                    ]
                ]
            }
        ],
        "meta": {
            "nf-test": "0.9.0-rc2",
            "nextflow": "24.10.0"
        },
        "timestamp": "2025-10-07T15:34:41.136241044"
    }
}